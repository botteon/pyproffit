

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyproffit package &mdash; pyproffit 0.5 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Example: Surface brightness profile extraction and fitting with PyProffit" href="Example.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> pyproffit
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyproffit.data">pyproffit.data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyproffit.deproject">pyproffit.deproject module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyproffit.emissivity">pyproffit.emissivity module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyproffit.fitting">pyproffit.fitting module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyproffit.hmc">pyproffit.hmc module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyproffit.miscellaneous">pyproffit.miscellaneous module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyproffit.models">pyproffit.models module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyproffit.power_spectrum">pyproffit.power_spectrum module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyproffit.profextract">pyproffit.profextract module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyproffit">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyproffit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>pyproffit package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pyproffit.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="pyproffit-package">
<h1>pyproffit package<a class="headerlink" href="#pyproffit-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyproffit.data">
<span id="pyproffit-data-module"></span><h2>pyproffit.data module<a class="headerlink" href="#module-pyproffit.data" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyproffit.data.Data">
<em class="property">class </em><code class="sig-prename descclassname">pyproffit.data.</code><code class="sig-name descname">Data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imglink</span></em>, <em class="sig-param"><span class="n">explink</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bkglink</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">voronoi</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">rmsmap</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/data.html#Data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.data.Data" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class containing the data to be loaded and used by other pyproffit routines</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imglink</strong> (<em>str</em>) – Path to input image</p></li>
<li><p><strong>explink</strong> (<em>str</em><em> , </em><em>optional</em>) – Path to exposure map. If none, assume a flat exposure of 1s or an input error map provided through rmsmap</p></li>
<li><p><strong>bkglink</strong> (<em>str</em><em> , </em><em>optional</em>) – Path to background map. If none, assume zero background</p></li>
<li><p><strong>voronoi</strong> (<em>bool</em><em> , </em><em>optional</em>) – Define whether the input image is a Voronoi image or not (default=False)</p></li>
<li><p><strong>rmsmap</strong> (<em>str</em><em> , </em><em>optional</em>) – Path to error map if the data is not Poisson distributed</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyproffit.data.Data.dmfilth">
<code class="sig-name descname">dmfilth</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/data.html#Data.dmfilth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.data.Data.dmfilth" title="Permalink to this definition">¶</a></dt>
<dd><p>Mask the regions provided in a region file and fill in the holes by interpolating the smoothed image into the gaps and generating a Poisson realization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>outfile</strong> (<em>str</em><em> , </em><em>optional</em>) – If outfile is not None, file name to output the dmfilth image into a FITS file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.data.Data.region">
<code class="sig-name descname">region</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">regfile</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/data.html#Data.region"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.data.Data.region" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter out regions provided in an input DS9 region file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>regfile</strong> (<em>str</em>) – Path to region file. Accepted region file formats are fk5 and image.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyproffit.data.get_extnum">
<code class="sig-prename descclassname">pyproffit.data.</code><code class="sig-name descname">get_extnum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fitsfile</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/data.html#get_extnum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.data.get_extnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the extension number of the first IMAGE extension in an input FITS file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fitsfile</strong> (<em>str</em>) – Input FITS file to be read</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>extension number</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyproffit.deproject">
<span id="pyproffit-deproject-module"></span><h2>pyproffit.deproject module<a class="headerlink" href="#module-pyproffit.deproject" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyproffit.deproject.Deproject">
<em class="property">class </em><code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">Deproject</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">profile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cf</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">f_abund</span><span class="o">=</span><span class="default_value">'aspl'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>pyproffit.Deproject class to perform all calculations of deprojection, density profile, gas mass, count rate, and luminosity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>float</em>) – Source redshift. If z=None, only the surface brightness reconstruction can be done.</p></li>
<li><p><strong>profile</strong> (class:<cite>pyproffit.profextract.Profile</cite>) – Object of type <a class="reference internal" href="#pyproffit.profextract.Profile" title="pyproffit.profextract.Profile"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyproffit.profextract.Profile</span></code></a> containing the surface brightness profile data</p></li>
<li><p><strong>cf</strong> (<em>float</em>) – Conversion factor from count rate to emissivity. If cf=None, only the surface brightness reconstruction can be done.</p></li>
<li><p><strong>f_abund</strong> (<em>str</em>) – Solar abundance table to compute the electron-to-proton ratio and mean molecular weight. Available tables are ‘aspl’ (Aspling+09, default), ‘angr’ (Anders &amp; Grevesse 89), and ‘grsa’ (Grevesse &amp; Sauval 98)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyproffit.deproject.Deproject.CSB">
<code class="sig-name descname">CSB</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rin</span><span class="o">=</span><span class="default_value">40.0</span></em>, <em class="sig-param"><span class="n">rout</span><span class="o">=</span><span class="default_value">400.0</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject.CSB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject.CSB" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the surface brightness concentration from a loaded brightness profile reconstruction. The surface brightness concentration is defined as the ratio of fluxes computed within two apertures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rin</strong> (<em>float</em>) – Lower aperture value in kpc (default=40)</p></li>
<li><p><strong>rout</strong> (<em>float</em>) – Higher aperture value in kpc (default=400)</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – Plot the posterior CSB distribution (default=True)</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Output file name to save the figure. If outfile=None, plot only to stdout</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median count rate, 16th and 84th percentiles</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.deproject.Deproject.CountRate">
<code class="sig-name descname">CountRate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject.CountRate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject.CountRate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the model count rate integrated between radii a and b. Optionally, the count rate distribution can be plotted and saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>float</em>) – Inner integration boundary in arcmin</p></li>
<li><p><strong>b</strong> (<em>float</em>) – Outer integration boundary in arcmin</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – Plot the posterior count rate distribution (default=True)</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Output file name to save the figure. If outfile=None, plot only to stdout</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median count rate, 16th and 84th percentiles</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.deproject.Deproject.Density">
<code class="sig-name descname">Density</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rout</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject.Density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject.Density" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a density profile from a multiscale reconstruction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rout</strong> (<em>numpy.ndarray</em>) – Radial binning of the density profile. If rout=None, the original binning of the surface brightness profile is used</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.deproject.Deproject.Mgas">
<code class="sig-name descname">Mgas</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">radius</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject.Mgas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject.Mgas" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the posterior cumulative gas mass within a given radius. . Optionally, the posterior distribution can be plotted and saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>float</em>) – Gas mass integration radius in kpc</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – Plot the posterior Mgas distribution (default=True)</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Output file name to save the figure. If outfile=None, plot only to stdout</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median count rate, 16th and 84th percentiles</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.deproject.Deproject.Multiscale">
<code class="sig-name descname">Multiscale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">backend</span><span class="o">=</span><span class="default_value">'pymc3'</span></em>, <em class="sig-param"><span class="n">nmcmc</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">bkglim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">back</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">samplefile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nrc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nbetas</span><span class="o">=</span><span class="default_value">6</span></em>, <em class="sig-param"><span class="n">depth</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">min_beta</span><span class="o">=</span><span class="default_value">0.6</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject.Multiscale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject.Multiscale" title="Permalink to this definition">¶</a></dt>
<dd><p>Run Multiscale deprojection using the method described in Eckert+20</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>backend</strong> (<em>strr</em>) – Backend to run the optimization problem. Available backends are ‘pymc3’ (default) and ‘stan’</p></li>
<li><p><strong>nmcmc</strong> (<em>int</em>) – Number of HMC points in the output sample</p></li>
<li><p><strong>bkglim</strong> (<em>float</em>) – Limit beyond which it is assumed that the background dominates, i.e. the source is set to 0. If bkglim=None (default), the entire radial range is used</p></li>
<li><p><strong>back</strong> (<em>float</em>) – Input value for the background, around which a gaussian prior is set. If back=None (default), the input background value will be computed as the average of the source-free region</p></li>
<li><p><strong>samplefile</strong> (<em>str</em>) – Path to output file to write the output samples. If samplefile=None (default), the data are not written to file and only loaded into memory</p></li>
<li><p><strong>nrc</strong> (<em>int</em>) – Number of core radii. If nrc=None (default), the number of core radiis will be defined on-the-fly</p></li>
<li><p><strong>nbetas</strong> (<em>int</em>) – Number of beta values. Default=6</p></li>
<li><p><strong>depth</strong> (<em>int</em>) – Set the max_treedepth parameter for Stan (default=10)</p></li>
<li><p><strong>min_beta</strong> (<em>float</em>) – Minimum value of beta. Default=0.6</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.deproject.Deproject.Ncounts">
<code class="sig-name descname">Ncounts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject.Ncounts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject.Ncounts" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the total model number of counts. Optionally, the posterior distribution can be plotted and saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot</strong> (<em>bool</em>) – Plot the posterior distribution of number of counts (default=True)</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Output file name to save the figure. If outfile=None, plot only to stdout</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median count rate, 16th and 84th percentiles</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.deproject.Deproject.OnionPeeling">
<code class="sig-name descname">OnionPeeling</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nmc</span><span class="o">=</span><span class="default_value">1000</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject.OnionPeeling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject.OnionPeeling" title="Permalink to this definition">¶</a></dt>
<dd><p>Run standard Onion Peeling deprojection using the Kriss+83 method and the McLaughlin+99 edge correction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nmc</strong> (<em>int</em>) – Number of Monte Carlo realizations of the profile to compute the uncertainties (default=1000)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.deproject.Deproject.PlotDensity">
<code class="sig-name descname">PlotDensity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xscale</span><span class="o">=</span><span class="default_value">'kpc'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject.PlotDensity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject.PlotDensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the loaded density profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outfile</strong> (<em>str</em>) – Output file name. If outfile=None (default) plot only to stdout</p></li>
<li><p><strong>xscale</strong> (<em>str</em>) – Choose whether the x axis should be in unit of ‘kpc’ (default), ‘arcmin’, or ‘both’, in which case two axes are drawn at the top and the bottom of the plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.deproject.Deproject.PlotMgas">
<code class="sig-name descname">PlotMgas</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rout</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xscale</span><span class="o">=</span><span class="default_value">'kpc'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject.PlotMgas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject.PlotMgas" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the cumulative gas mass profile from the output of a reconstruction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rout</strong> (<em>numpy.ndarray</em>) – Radial binning of the gas mass profile. If rout=None, the original binning of the surface brightness profile is used</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Output file name to save the figure. If outfile=None, plot only to stdout</p></li>
<li><p><strong>xscale</strong> (<em>str</em>) – Choose whether the x axis should be in unit of ‘kpc’ (default), ‘arcmin’, or ‘both’, in which case two axes are drawn at the top and the bottom of the plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.deproject.Deproject.PlotSB">
<code class="sig-name descname">PlotSB</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject.PlotSB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject.PlotSB" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the surface brightness profile reconstructed after applying the multiscale deprojection and PSF deconvolution technique, and compare it with the input brightness profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>outfile</strong> (<em>str</em>) – File name of saving the output figure. If outfile=None (default), plot only to stdout</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.deproject.Deproject.Reload">
<code class="sig-name descname">Reload</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samplefile</span></em>, <em class="sig-param"><span class="n">bkglim</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject.Reload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject.Reload" title="Permalink to this definition">¶</a></dt>
<dd><p>Reload the samples stored from a previous reconstruction run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samplefile</strong> (<em>str</em>) – Path to file containing the saved HMC samples</p></li>
<li><p><strong>bkglim</strong> (<em>float</em>) – Limit beyond which it is assumed that the background dominates, i.e. the source is set to 0. This parameter needs to be the same as the value used to run the reconstruction. If bkglim=None (default), the entire radial range is used</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.deproject.Deproject.SaveAll">
<code class="sig-name descname">SaveAll</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject.SaveAll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject.SaveAll" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the results of a profile reconstruction into an output FITS file
First extension is data
Second extension is density
Third extension is Mgas
Fourth extension is PSF</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>outfile</strong> (<em>str</em>) – Output file name</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.Deproject_Multiscale_PyMC3">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">Deproject_Multiscale_PyMC3</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">deproj</span></em>, <em class="sig-param"><span class="n">bkglim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nmcmc</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">back</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">samplefile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nrc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nbetas</span><span class="o">=</span><span class="default_value">6</span></em>, <em class="sig-param"><span class="n">min_beta</span><span class="o">=</span><span class="default_value">0.6</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject_Multiscale_PyMC3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject_Multiscale_PyMC3" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the multiscale deprojection optimization using the PyMC3 backend</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deproj</strong> (<em>pyproffit.Deproject</em>) – Object containing the data and parameters</p></li>
<li><p><strong>bkglim</strong> (<em>float</em>) – Limit beyond which it is assumed that the background dominates, i.e. the source is set to 0. If bkglim=None (default), the entire radial range is used</p></li>
<li><p><strong>nmcmc</strong> (<em>int</em>) – Number of HMC points in the output sample</p></li>
<li><p><strong>back</strong> (<em>float</em>) – Input value for the background, around which a gaussian prior is set. If back=None (default), the input background value will be computed as the average of the source-free region</p></li>
<li><p><strong>samplefile</strong> (<em>str</em>) – Path to output file to write the output samples. If samplefile=None (default), the data are not written to file and only loaded into memory</p></li>
<li><p><strong>nrc</strong> (<em>int</em>) – Number of core radii. If nrc=None (default), the number of core radiis will be defined on-the-fly</p></li>
<li><p><strong>nbetas</strong> (<em>int</em>) – Number of beta values. Default=6</p></li>
<li><p><strong>min_beta</strong> (<em>float</em>) – Minimum value of beta. Default=0.6</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.Deproject_Multiscale_Stan">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">Deproject_Multiscale_Stan</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">deproj</span></em>, <em class="sig-param"><span class="n">bkglim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nmcmc</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">back</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">samplefile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nrc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nbetas</span><span class="o">=</span><span class="default_value">6</span></em>, <em class="sig-param"><span class="n">depth</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">min_beta</span><span class="o">=</span><span class="default_value">0.6</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#Deproject_Multiscale_Stan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.Deproject_Multiscale_Stan" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the multiscale deprojection optimization using the Stan backend</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deproj</strong> (<em>pyproffit.Deproject</em>) – Object containing the data and parameters</p></li>
<li><p><strong>bkglim</strong> (<em>float</em>) – Limit beyond which it is assumed that the background dominates, i.e. the source is set to 0. If bkglim=None (default), the entire radial range is used</p></li>
<li><p><strong>nmcmc</strong> (<em>int</em>) – Number of HMC points in the output sample</p></li>
<li><p><strong>back</strong> (<em>float</em>) – Input value for the background, around which a gaussian prior is set. If back=None (default), the input background value will be computed as the average of the source-free region</p></li>
<li><p><strong>samplefile</strong> (<em>str</em>) – Path to output file to write the output samples. If samplefile=None (default), the data are not written to file and only loaded into memory</p></li>
<li><p><strong>nrc</strong> (<em>int</em>) – Number of core radii. If nrc=None (default), the number of core radiis will be defined on-the-fly</p></li>
<li><p><strong>nbetas</strong> (<em>int</em>) – Number of beta values. Default=6</p></li>
<li><p><strong>depth</strong> (<em>int</em>) – Set the max_treedepth parameter for Stan (default=10)</p></li>
<li><p><strong>min_beta</strong> (<em>float</em>) – Minimum value of beta. Default=0.6</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.EdgeCorr">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">EdgeCorr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nbin</span></em>, <em class="sig-param"><span class="n">rin_cm</span></em>, <em class="sig-param"><span class="n">rout_cm</span></em>, <em class="sig-param"><span class="n">em0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#EdgeCorr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.EdgeCorr" title="Permalink to this definition">¶</a></dt>
<dd><p>For Onion Peeling deprojection, correct for edge effects by estimating the contribution of flux beyond the edge, using McLaughlin+99 method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nbin</strong> (<em>int</em>) – Number of bins in input profile</p></li>
<li><p><strong>rin_cm</strong> (<em>numpy.ndarray</em>) – Inner radii of the bins in cm</p></li>
<li><p><strong>rout_cm</strong> (<em>numpy.ndarray</em>) – Outer radii of the bins in cm</p></li>
<li><p><strong>em0</strong> (<em>numpy.ndarray</em>) – Deprojected emissivity profile before edge correction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Edge-corrected deprojected profile</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="pyproffit.deproject.MyDeprojVol">
<em class="property">class </em><code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">MyDeprojVol</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">radin</span></em>, <em class="sig-param"><span class="n">radout</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#MyDeprojVol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.MyDeprojVol" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to compute the projection volumes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radin</strong> (class:<cite>numpy.ndarray</cite>) – Array of inner radii of the bins</p></li>
<li><p><strong>radout</strong> (class:<cite>numpy.ndarray</cite>) – Array of outer radii of the bins</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyproffit.deproject.MyDeprojVol.deproj_vol">
<code class="sig-name descname">deproj_vol</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#MyDeprojVol.deproj_vol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.MyDeprojVol.deproj_vol" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the projection volumes</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Volume matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.OP">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">OP</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">deproj</span></em>, <em class="sig-param"><span class="n">nmc</span><span class="o">=</span><span class="default_value">1000</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#OP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.OP" title="Permalink to this definition">¶</a></dt>
<dd><p>Run standard Onion Peeling deprojection including edge correction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deproj</strong> (<em>pyproffit.Deproject</em>) – Input data</p></li>
<li><p><strong>nmc</strong> (<em>int</em>) – Number of Monte Carlo realizations of the profile to compute the uncertainties (default=1000)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.calc_density_operator">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">calc_density_operator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rad</span></em>, <em class="sig-param"><span class="n">pars</span></em>, <em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#calc_density_operator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.calc_density_operator" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute linear operator to transform parameters into gas density profiles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rad</strong> (<em>numpy.ndarray</em>) – Array of input radii in arcmin</p></li>
<li><p><strong>pars</strong> (<em>numpy.ndarray</em>) – List of beta model parameters obtained through list_params</p></li>
<li><p><strong>z</strong> (<em>float</em>) – Source redshift</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Linear operator for gas density</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.calc_int_operator">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">calc_int_operator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em>, <em class="sig-param"><span class="n">pars</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#calc_int_operator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.calc_int_operator" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a linear operator to integrate analytically the basis functions within some radial range and return count rate and luminosities</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>float</em>) – Lower integration boundary</p></li>
<li><p><strong>b</strong> (<em>float</em>) – Upper integration boundary</p></li>
<li><p><strong>pars</strong> (<em>numpy.ndarray</em>) – List of beta model parameters obtained through list_params</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Linear integration operator</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.calc_linear_operator">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">calc_linear_operator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rad</span></em>, <em class="sig-param"><span class="n">sourcereg</span></em>, <em class="sig-param"><span class="n">pars</span></em>, <em class="sig-param"><span class="n">area</span></em>, <em class="sig-param"><span class="n">expo</span></em>, <em class="sig-param"><span class="n">psf</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#calc_linear_operator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.calc_linear_operator" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to calculate a linear operator transforming parameter vector into predicted model counts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rad</strong> (<em>numpy.ndarray</em>) – Array of input radii in arcmin</p></li>
<li><p><strong>sourcereg</strong> (<em>numpy.ndarray</em>) – Selection array for the source region</p></li>
<li><p><strong>pars</strong> (<em>numpy.ndarray</em>) – List of beta model parameters obtained through list_params</p></li>
<li><p><strong>area</strong> (<em>numpy.ndarray</em>) – Bin area in arcmin^2</p></li>
<li><p><strong>expo</strong> (<em>numpy.ndarray</em>) – Bin effective exposure in s</p></li>
<li><p><strong>psf</strong> (<em>numpy.ndarray</em>) – PSF mixing matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Linear projection and PSF mixing operator</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.calc_sb_operator">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">calc_sb_operator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rad</span></em>, <em class="sig-param"><span class="n">sourcereg</span></em>, <em class="sig-param"><span class="n">pars</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#calc_sb_operator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.calc_sb_operator" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to calculate a linear operator transforming parameter vector into surface brightness</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rad</strong> (<em>numpy.ndarray</em>) – Array of input radii in arcmin</p></li>
<li><p><strong>sourcereg</strong> (<em>numpy.ndarray</em>) – Selection array for the source region</p></li>
<li><p><strong>pars</strong> (<em>numpy.ndarray</em>) – List of beta model parameters obtained through list_params</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Linear projection operator</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.calc_sb_operator_psf">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">calc_sb_operator_psf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rad</span></em>, <em class="sig-param"><span class="n">sourcereg</span></em>, <em class="sig-param"><span class="n">pars</span></em>, <em class="sig-param"><span class="n">area</span></em>, <em class="sig-param"><span class="n">expo</span></em>, <em class="sig-param"><span class="n">psf</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#calc_sb_operator_psf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.calc_sb_operator_psf" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as calc_sb_operator but convolving the model surface brightness with the PSF model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rad</strong> (<em>numpy.ndarray</em>) – Array of input radii in arcmin</p></li>
<li><p><strong>sourcereg</strong> (<em>numpy.ndarray</em>) – Selection array for the source region</p></li>
<li><p><strong>pars</strong> (<em>numpy.ndarray</em>) – List of beta model parameters obtained through list_params</p></li>
<li><p><strong>area</strong> (<em>numpy.ndarray</em>) – Bin area in arcmin^2</p></li>
<li><p><strong>expo</strong> (<em>numpy.ndarray</em>) – Bin effective exposure in s</p></li>
<li><p><strong>psf</strong> (<em>numpy.ndarray</em>) – PSF mixing matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Linear projection and PSF mixing operator</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.fbul19">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">fbul19</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">Runit</span><span class="o">=</span><span class="default_value">'kpc'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#fbul19"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.fbul19" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Mgas from input R500 using Bulbul+19 M-Mgas scaling relation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R</strong> (<em>float</em>) – Input R500 value</p></li>
<li><p><strong>z</strong> (<em>float</em>) – Input redshift</p></li>
<li><p><strong>Runit</strong> (<em>str</em>) – Unit of input radis, kpc or arcmin (default=’kpc’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mgas</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.list_params">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">list_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rad</span></em>, <em class="sig-param"><span class="n">sourcereg</span></em>, <em class="sig-param"><span class="n">nrc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nbetas</span><span class="o">=</span><span class="default_value">6</span></em>, <em class="sig-param"><span class="n">min_beta</span><span class="o">=</span><span class="default_value">0.6</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#list_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.list_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a list of parameters to define the dictionary of basis functions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rad</strong> (<em>numpy.ndarray</em>) – Array of input radii in arcmin</p></li>
<li><p><strong>sourcereg</strong> (<em>numpy.ndarray</em>) – Selection array for the source region</p></li>
<li><p><strong>nrc</strong> (<em>int</em>) – Number of core radii. If nrc=None (default), the number of core radiis will be defined on-the-fly</p></li>
<li><p><strong>nbetas</strong> (<em>int</em>) – Number of beta values. Default=6</p></li>
<li><p><strong>min_beta</strong> (<em>float</em>) – Minimum value of beta. Default=0.6</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array containing sets of values to set up the function dictionary</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.list_params_density">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">list_params_density</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rad</span></em>, <em class="sig-param"><span class="n">sourcereg</span></em>, <em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">nrc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nbetas</span><span class="o">=</span><span class="default_value">6</span></em>, <em class="sig-param"><span class="n">min_beta</span><span class="o">=</span><span class="default_value">0.6</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#list_params_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.list_params_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a list of parameters to transform the basis functions into gas density profiles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rad</strong> (<em>numpy.ndarray</em>) – Array of input radii in arcmin</p></li>
<li><p><strong>sourcereg</strong> (<em>numpy.ndarray</em>) – Selection array for the source region</p></li>
<li><p><strong>z</strong> (<em>float</em>) – Source redshift</p></li>
<li><p><strong>nrc</strong> (<em>int</em>) – Number of core radii. If nrc=None (default), the number of core radiis will be defined on-the-fly</p></li>
<li><p><strong>nbetas</strong> (<em>int</em>) – Number of beta values. Default=6</p></li>
<li><p><strong>min_beta</strong> (<em>float</em>) – Minimum value of beta. Default=0.6</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array containing sets of values to set up the function dictionary</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.medsmooth">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">medsmooth</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prof</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#medsmooth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.medsmooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth a given profile by taking the median value of surrounding points instead of the initial value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prof</strong> (<em>numpy.ndarray</em>) – Input profile to be smoothed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Smoothd profile</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.deproject.plot_multi_methods">
<code class="sig-prename descclassname">pyproffit.deproject.</code><code class="sig-name descname">plot_multi_methods</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">profs</span></em>, <em class="sig-param"><span class="n">deps</span></em>, <em class="sig-param"><span class="n">labels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/deproject.html#plot_multi_methods"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.deproject.plot_multi_methods" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot multiple gas density profiles (e.g. obtained through several methods, centers or sectors) to compare them</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>profs</strong> (<em>tuple</em>) – List of Profile objects to be plotted</p></li>
<li><p><strong>deps</strong> (<em>tuple</em>) – List of Deproject objects to be plotted</p></li>
<li><p><strong>labels</strong> (<em>tuple</em>) – List of labels for the legend (default=None)</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – If outfile is not None, path to file name to output the plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matplotlib figure object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class:<cite>matplotlib.figure</cite></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyproffit.emissivity">
<span id="pyproffit-emissivity-module"></span><h2>pyproffit.emissivity module<a class="headerlink" href="#module-pyproffit.emissivity" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyproffit.emissivity.calc_emissivity">
<code class="sig-prename descclassname">pyproffit.emissivity.</code><code class="sig-name descname">calc_emissivity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cosmo</span></em>, <em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">nh</span></em>, <em class="sig-param"><span class="n">kt</span></em>, <em class="sig-param"><span class="n">rmf</span></em>, <em class="sig-param"><span class="n">Z</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">elow</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">ehigh</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">arf</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">type</span><span class="o">=</span><span class="default_value">'cr'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/emissivity.html#calc_emissivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.emissivity.calc_emissivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Function calc_emissivity. The function computes the scaling factor between count rate and APEC/MEKAL norm using XSPEC, which is needed to extract density profiles.
Requires XSPEC to be in PATH</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cosmo</strong> (<em>class: astropy.cosmology</em>) – Astropy cosmology object</p></li>
<li><p><strong>z</strong> (<em>float</em>) – Source redshift</p></li>
<li><p><strong>nh</strong> (<em>float</em>) – Source NH in units of 1e22 cm**(-2)</p></li>
<li><p><strong>kt</strong> (<em>float</em>) – Source temperature in keV</p></li>
<li><p><strong>rmf</strong> (<em>str</em>) – Path to response file (RMF/RSP)</p></li>
<li><p><strong>Z</strong> (<em>float</em>) – Metallicity with respect to solar (default = 0.3)</p></li>
<li><p><strong>elow</strong> (<em>float</em>) – Low-energy bound of the input image in keV (default = 0.5)</p></li>
<li><p><strong>ehigh</strong> (<em>float</em>) – High-energy bound of the input image in keV (default = 2.0)</p></li>
<li><p><strong>arf</strong> (<em>str</em>) – Path to on-axis ARF (optional, in case response file is RMF)</p></li>
<li><p><strong>type</strong> (<em>str</em>) – Specify whether the exposure map is in units of sec (type=’cr’) or photon flux (type=’photon’). By default type=’cr’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Conversion factor</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.emissivity.is_tool">
<code class="sig-prename descclassname">pyproffit.emissivity.</code><code class="sig-name descname">is_tool</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/emissivity.html#is_tool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.emissivity.is_tool" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether <cite>name</cite> is on PATH.</p>
</dd></dl>

</div>
<div class="section" id="module-pyproffit.fitting">
<span id="pyproffit-fitting-module"></span><h2>pyproffit.fitting module<a class="headerlink" href="#module-pyproffit.fitting" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyproffit.fitting.ChiSquared">
<em class="property">class </em><code class="sig-prename descclassname">pyproffit.fitting.</code><code class="sig-name descname">ChiSquared</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">dx</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">dy</span></em>, <em class="sig-param"><span class="n">psfmat</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fitlow</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fithigh</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/fitting.html#ChiSquared"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.fitting.ChiSquared" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class defining a chi-square likelihood based on a surface brightness profile and a model. This class is called by the Fitter object when using the method=’chi2’ option.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (class:<cite>pyproffit.models.Model</cite>) – Model definition. A <a class="reference internal" href="#pyproffit.models.Model" title="pyproffit.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyproffit.models.Model</span></code></a> object defining the model to be used.</p></li>
<li><p><strong>x</strong> (class:<cite>numpy.ndarray</cite>) – x axis data</p></li>
<li><p><strong>dx</strong> (class:<cite>numpy.ndarray</cite>) – x bin size data. dx is defined as half of the total bin size.</p></li>
<li><p><strong>y</strong> (class:<cite>numpy.ndarray</cite>) – y axis data</p></li>
<li><p><strong>dy</strong> (class:<cite>numpy.ndarray</cite>) – y error data</p></li>
<li><p><strong>psfmat</strong> (class:<cite>numpy.ndarray</cite> , optional) – PSF convolution matrix</p></li>
<li><p><strong>fitlow</strong> (<em>float</em><em> , </em><em>optional</em>) – Lower fitting boundary in arcmin. If fitlow=None the entire radial range is used, default to None</p></li>
<li><p><strong>fithigh</strong> (<em>float</em><em> , </em><em>optional</em>) – Upper fitting boundary in arcmin. If fithigh=None the entire radial range is used, default to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="pyproffit.fitting.Cstat">
<em class="property">class </em><code class="sig-prename descclassname">pyproffit.fitting.</code><code class="sig-name descname">Cstat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">counts</span></em>, <em class="sig-param"><span class="n">area</span></em>, <em class="sig-param"><span class="n">effexp</span></em>, <em class="sig-param"><span class="n">bkgc</span></em>, <em class="sig-param"><span class="n">psfmat</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fitlow</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fithigh</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/fitting.html#Cstat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.fitting.Cstat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class defining a C-stat likelihood based on a surface brightness profile and a model. This class is called by the Fitter object when using the method=’cstat’ option.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (class:<cite>pyproffit.models.Model</cite>) – Model definition. A <a class="reference internal" href="#pyproffit.models.Model" title="pyproffit.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyproffit.models.Model</span></code></a> object defining the model to be used.</p></li>
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – x axis data</p></li>
<li><p><strong>counts</strong> (<em>numpy.ndarray</em>) – counts per bin data</p></li>
<li><p><strong>area</strong> (<em>numpy.ndarray</em>) – bin are in arcmin^2</p></li>
<li><p><strong>effexp</strong> (<em>numpy.ndarray</em>) – bin effective exposure in s</p></li>
<li><p><strong>bkgc</strong> (<em>numpy.ndarray</em>) – number of background counts per bin</p></li>
<li><p><strong>psfmat</strong> (<em>numpy.ndarray</em>) – PSF convolution matrix</p></li>
<li><p><strong>fitlow</strong> (<em>float</em>) – Lower fitting boundary in arcmin. If fitlow=None (default) the entire radial range is used</p></li>
<li><p><strong>fithigh</strong> (<em>float</em>) – Upper fitting boundary in arcmin. If fithigh=None (default) the entire radial range is used</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="pyproffit.fitting.Fitter">
<em class="property">class </em><code class="sig-prename descclassname">pyproffit.fitting.</code><code class="sig-name descname">Fitter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">profile</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/fitting.html#Fitter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.fitting.Fitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class containing the tools to fit surface brightness profiles with a model. Sets up the likelihood and optimizes for the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (class:<cite>pyproffit.models.Model</cite>) – Object of type <a class="reference internal" href="#pyproffit.models.Model" title="pyproffit.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyproffit.models.Model</span></code></a> defining the model to be used.</p></li>
<li><p><strong>profile</strong> (class:<cite>pyproffit.profextract.Profile</cite>) – Object of type <a class="reference internal" href="#pyproffit.profextract.Profile" title="pyproffit.profextract.Profile"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyproffit.profextract.Profile</span></code></a> containing the surface brightness profile to be fitted</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyproffit.fitting.Fitter.Migrad">
<code class="sig-name descname">Migrad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'chi2'</span></em>, <em class="sig-param"><span class="n">fitlow</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fithigh</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/fitting.html#Fitter.Migrad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.fitting.Fitter.Migrad" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform maximum-likelihood optimization of the model using the MIGRAD routine from the MINUIT library.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – Likelihood function to be optimized. Available likelihoods are ‘chi2’ (chi-squared) and ‘cstat’ (C statistic). Defaults to ‘chi2’.</p></li>
<li><p><strong>fitlow</strong> (<em>float</em>) – Lower boundary of the active fitting radial range. If fitlow=None the entire range is used. Defaults to None</p></li>
<li><p><strong>fithigh</strong> (<em>float</em>) – Upper boundary of the active fitting radial range. If fithigh=None the entire range is used. Defaults to None</p></li>
<li><p><strong>kwargs</strong> – List of arguments to be passed to the iminuit library. For instance, setting parameter boundaries, optimization options or fixing parameters.
See the iminuit documentation: <a class="reference external" href="https://iminuit.readthedocs.io/en/stable/index.html">https://iminuit.readthedocs.io/en/stable/index.html</a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyproffit.hmc">
<span id="pyproffit-hmc-module"></span><h2>pyproffit.hmc module<a class="headerlink" href="#module-pyproffit.hmc" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyproffit.hmc.fit_profile_pymc3">
<code class="sig-prename descclassname">pyproffit.hmc.</code><code class="sig-name descname">fit_profile_pymc3</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fitter</span></em>, <em class="sig-param"><span class="n">fitlow</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fithigh</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/hmc.html#fit_profile_pymc3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.hmc.fit_profile_pymc3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-pyproffit.miscellaneous">
<span id="pyproffit-miscellaneous-module"></span><h2>pyproffit.miscellaneous module<a class="headerlink" href="#module-pyproffit.miscellaneous" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyproffit.miscellaneous.bkg_smooth">
<code class="sig-prename descclassname">pyproffit.miscellaneous.</code><code class="sig-name descname">bkg_smooth</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">smoothing_scale</span><span class="o">=</span><span class="default_value">25</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/miscellaneous.html#bkg_smooth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.miscellaneous.bkg_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth an input background image using a broad Gaussian</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (class:<cite>numpy.ndarray</cite>) – 2D array</p></li>
<li><p><strong>smoothing_scale</strong> (<em>float</em>) – Size of Gaussian smoothing kernel in pixel. Defaults to 25</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>smoothed image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class:<cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.miscellaneous.clean_bkg">
<code class="sig-prename descclassname">pyproffit.miscellaneous.</code><code class="sig-name descname">clean_bkg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">img</span></em>, <em class="sig-param"><span class="n">bkg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/miscellaneous.html#clean_bkg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.miscellaneous.clean_bkg" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract statistically the background from a Poisson image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (class:<cite>numpy.ndarray</cite>) – Input image</p></li>
<li><p><strong>bkg</strong> (class:<cite>numpy.ndarray</cite>) – Background map</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Background subtracted Poisson image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class:<cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.miscellaneous.dist_eval">
<code class="sig-prename descclassname">pyproffit.miscellaneous.</code><code class="sig-name descname">dist_eval</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coords2d</span></em>, <em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_c</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y_c</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metric</span><span class="o">=</span><span class="default_value">'euclidean'</span></em>, <em class="sig-param"><span class="n">selected</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/miscellaneous.html#dist_eval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.miscellaneous.dist_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Computed distance of a set of points to a centroid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords2d</strong> (class:<cite>numpy.ndarray</cite>) – 2D array with shape (N,2), N is the number of points</p></li>
<li><p><strong>index</strong> (class:<cite>numpy.ndarray</cite>) – index defining input value for the centroid</p></li>
<li><p><strong>x_c</strong> (<em>float</em>) – input centroid X axis coordinate</p></li>
<li><p><strong>y_c</strong> (<em>float</em>) – input centroid Y axis coordinate</p></li>
<li><p><strong>metric</strong> (<em>str</em><em> , </em><em>optional</em>) – metric system (defaults to ‘euclidean’)</p></li>
<li><p><strong>selected</strong> (class:<cite>numpy.ndarray</cite> , optional) – index defining a selected subset of points to be used</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>distance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class:<cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.miscellaneous.get_bary">
<code class="sig-prename descclassname">pyproffit.miscellaneous.</code><code class="sig-name descname">get_bary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">x_c</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y_c</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weight</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wdist</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/miscellaneous.html#get_bary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.miscellaneous.get_bary" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute centroid position and ellipse parameters from a set of points using principle component analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (class:<cite>numpy.ndarray</cite>) – Array of positions on the X axis</p></li>
<li><p><strong>y</strong> (class:<cite>numpy.ndarray</cite>) – Array of positions on the Y axis</p></li>
<li><p><strong>x_c</strong> (<em>float</em><em> , </em><em>optional</em>) – Initial guess for the centroid X axis value</p></li>
<li><p><strong>y_c</strong> (<em>float</em><em> , </em><em>optional</em>) – Initial guess for the centroid X axis value</p></li>
<li><p><strong>weight</strong> (class:<cite>numpy.ndarray</cite> , optional) – Weights to be applied to the points when computing the average</p></li>
<li><p><strong>wdist</strong> (<em>bool</em>) – Switch to apply the weights. Defaults to False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>x_c_w (float): Centroid X coordinate</p></li>
<li><p>y_c_w (float): Centroid Y coordinate</p></li>
<li><p>sig_x (float): X axis standard deviation</p></li>
<li><p>sig_y (float): Y axis standard deviation</p></li>
<li><p>r_cluster (float): characteristic size of cluster</p></li>
<li><p>semi_major_angle (float): rotation angle of ellipse</p></li>
<li><p>pos_err (float): positional error on the centroid</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.miscellaneous.heaviside">
<code class="sig-prename descclassname">pyproffit.miscellaneous.</code><code class="sig-name descname">heaviside</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/miscellaneous.html#heaviside"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.miscellaneous.heaviside" title="Permalink to this definition">¶</a></dt>
<dd><p>Heavyside theta function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (class:<cite>numpy.ndarray</cite>) – 2D array</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>filter</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class:<cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.miscellaneous.logbinning">
<code class="sig-prename descclassname">pyproffit.miscellaneous.</code><code class="sig-name descname">logbinning</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">binsize</span></em>, <em class="sig-param"><span class="n">maxrad</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/miscellaneous.html#logbinning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.miscellaneous.logbinning" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up a logarithmic binning scheme with a minimum bin size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>binsize</strong> (<em>float</em>) – Minimum bin size in arcsec</p></li>
<li><p><strong>maxrad</strong> (<em>float</em>) – Maximum extraction radius in arcmin</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bins and bin width</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class:<cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.miscellaneous.medianval">
<code class="sig-prename descclassname">pyproffit.miscellaneous.</code><code class="sig-name descname">medianval</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vals</span></em>, <em class="sig-param"><span class="n">errs</span></em>, <em class="sig-param"><span class="n">nsim</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/miscellaneous.html#medianval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.miscellaneous.medianval" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the median value of a sample of values and compute its uncertainty using Monte Carlo simulations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vals</strong> (class:<cite>numpy.ndarray</cite>) – Array containing the set of values in the sample</p></li>
<li><p><strong>errs</strong> (class:<cite>numpy.ndarray</cite>) – Array contatining the error on each value</p></li>
<li><p><strong>nsim</strong> (<em>int</em>) – Number of Monte Carlo simulations to be performed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>med (float): Median of sample</p></li>
<li><p>err (float): Error on median</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyproffit.models">
<span id="pyproffit-models-module"></span><h2>pyproffit.models module<a class="headerlink" href="#module-pyproffit.models" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyproffit.models.BetaModel">
<code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">BetaModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">beta</span></em>, <em class="sig-param"><span class="n">rc</span></em>, <em class="sig-param"><span class="n">norm</span></em>, <em class="sig-param"><span class="n">bkg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#BetaModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.BetaModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Single Beta model</p>
<div class="math notranslate nohighlight">
\[I(r) = I_0 \left(1 + (x/r_c)^2\right) ^ {-3 \beta + 0.5} + B\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Radius in arcmin</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – <span class="math notranslate nohighlight">\(\beta\)</span> parameter</p></li>
<li><p><strong>rc</strong> (<em>float</em>) – rc parameter</p></li>
<li><p><strong>norm</strong> (<em>float</em>) – log of I0 parameter</p></li>
<li><p><strong>bkg</strong> (<em>float</em>) – log of B parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Calculated model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.models.BetaModelPM">
<code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">BetaModelPM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">beta</span></em>, <em class="sig-param"><span class="n">rc</span></em>, <em class="sig-param"><span class="n">norm</span></em>, <em class="sig-param"><span class="n">bkg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#BetaModelPM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.BetaModelPM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyproffit.models.BknPow">
<code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">BknPow</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">alpha1</span></em>, <em class="sig-param"><span class="n">alpha2</span></em>, <em class="sig-param"><span class="n">rf</span></em>, <em class="sig-param"><span class="n">norm</span></em>, <em class="sig-param"><span class="n">jump</span></em>, <em class="sig-param"><span class="n">bkg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#BknPow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.BknPow" title="Permalink to this definition">¶</a></dt>
<dd><p>Broken power law 3D model projected along the line of sight for discontinuity modeling</p>
<div class="math notranslate nohighlight">
\[I(r) = I_0 \int F(\omega)^2 d\ell + B\]</div>
<p>with <span class="math notranslate nohighlight">\(\omega^2 = r^2 + \ell^2\)</span> and</p>
<div class="math notranslate nohighlight">
\[\begin{split}F(\omega) = \left\{ \begin{array}{ll} \omega^{-\alpha_1}, &amp; \omega&lt;r_f \\ \frac{1}{C}\omega ^{-\alpha_2}, &amp; \omega\geq r_f
\end{array} \right.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Radius in arcmin</p></li>
<li><p><strong>alpha1</strong> (<em>float</em>) – <span class="math notranslate nohighlight">\(\alpha_1\)</span> parameter</p></li>
<li><p><strong>alpha2</strong> (<em>float</em>) – <span class="math notranslate nohighlight">\(\alpha_2\)</span> parameter</p></li>
<li><p><strong>rf</strong> (<em>float</em>) – rf parameter</p></li>
<li><p><strong>norm</strong> (<em>float</em>) – log of I0 parameter</p></li>
<li><p><strong>jump</strong> (<em>float</em>) – C parameter</p></li>
<li><p><strong>bkg</strong> (<em>float</em>) – log of B parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Calculated model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.models.Const">
<code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">Const</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">bkg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#Const"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.Const" title="Permalink to this definition">¶</a></dt>
<dd><p>Constal model for background fitting</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Radius in arcmin</p></li>
<li><p><strong>bkg</strong> (<em>float</em>) – log of B parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Calculated model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.models.ConstPM">
<code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">ConstPM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">bkg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#ConstPM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.ConstPM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyproffit.models.DoubleBeta">
<code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">DoubleBeta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">beta</span></em>, <em class="sig-param"><span class="n">rc1</span></em>, <em class="sig-param"><span class="n">rc2</span></em>, <em class="sig-param"><span class="n">ratio</span></em>, <em class="sig-param"><span class="n">norm</span></em>, <em class="sig-param"><span class="n">bkg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#DoubleBeta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.DoubleBeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Double beta model</p>
<div class="math notranslate nohighlight">
\[I(r) = I_0 \left[ (1 + (x/r_{c,1}) ^ 2)^{-3 \beta + 0.5} + R ( 1 + (x/r_{c,2}) ^ 2 )^{-3 \beta+0.5} \right] + B\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Radius in arcmin</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – <span class="math notranslate nohighlight">\(\beta\)</span> parameter</p></li>
<li><p><strong>rc1</strong> (<em>float</em>) – rc1 parameter</p></li>
<li><p><strong>rc2</strong> (<em>float</em>) – rc2 parameters</p></li>
<li><p><strong>ratio</strong> (<em>float</em>) – R parameter</p></li>
<li><p><strong>norm</strong> (<em>float</em>) – log of I0 parameter</p></li>
<li><p><strong>bkg</strong> (<em>float</em>) – log of B parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Calculated model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.models.DoubleBetaPM">
<code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">DoubleBetaPM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">beta</span></em>, <em class="sig-param"><span class="n">rc1</span></em>, <em class="sig-param"><span class="n">rc2</span></em>, <em class="sig-param"><span class="n">ratio</span></em>, <em class="sig-param"><span class="n">norm</span></em>, <em class="sig-param"><span class="n">bkg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#DoubleBetaPM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.DoubleBetaPM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyproffit.models.IntFunc">
<code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">IntFunc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">omega</span></em>, <em class="sig-param"><span class="n">rf</span></em>, <em class="sig-param"><span class="n">alpha</span></em>, <em class="sig-param"><span class="n">xmin</span></em>, <em class="sig-param"><span class="n">xmax</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#IntFunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.IntFunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Numerical integration of a power law along the line of sight</p>
<div class="math notranslate nohighlight">
\[\int_{x_{min}}^{x_{max}} \left(\frac{\omega^2 + \ell^2}{r_f^2}\right)^{-\alpha} d\ell\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>omega</strong> (<em>float</em>) – Projected radius</p></li>
<li><p><strong>rf</strong> (<em>float</em>) – rf parameter</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – <span class="math notranslate nohighlight">\(\alpha\)</span> parameter</p></li>
<li><p><strong>xmin</strong> (<em>float</em>) – xmin parameter</p></li>
<li><p><strong>xmax</strong> (<em>float</em>) – xmax parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Line-of-sight integral</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.models.IntFuncPM">
<code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">IntFuncPM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">omega</span></em>, <em class="sig-param"><span class="n">rf</span></em>, <em class="sig-param"><span class="n">alpha</span></em>, <em class="sig-param"><span class="n">xmin</span></em>, <em class="sig-param"><span class="n">xmax</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#IntFuncPM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.IntFuncPM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="pyproffit.models.Model">
<em class="property">class </em><code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">Model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">vals</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#Model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class containing pyproffit models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>function</em>) – Function to be used as surface brightness model</p></li>
<li><p><strong>vals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Array containing initial values for the parameters (optional)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyproffit.models.Model.SetErrors">
<code class="sig-name descname">SetErrors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vals</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#Model.SetErrors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.Model.SetErrors" title="Permalink to this definition">¶</a></dt>
<dd><p>Set input values for the errors on the parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Array containing initial values for the errors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.models.Model.SetParameters">
<code class="sig-name descname">SetParameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vals</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#Model.SetParameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.Model.SetParameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Set input values for the model parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Array containing initial values for the parameters</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyproffit.models.PowerLaw">
<code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">PowerLaw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">alpha</span></em>, <em class="sig-param"><span class="n">norm</span></em>, <em class="sig-param"><span class="n">pivot</span></em>, <em class="sig-param"><span class="n">bkg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#PowerLaw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.PowerLaw" title="Permalink to this definition">¶</a></dt>
<dd><p>Single power law model in projected space</p>
<div class="math notranslate nohighlight">
\[I(r)=I_0\left( \frac{x}{x_p} \right)^{-\alpha} + B\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Radius in arcmin</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – <span class="math notranslate nohighlight">\(\alpha\)</span> parameter</p></li>
<li><p><strong>norm</strong> (<em>float</em>) – log of I0 parameter</p></li>
<li><p><strong>pivot</strong> (<em>float</em>) – <span class="math notranslate nohighlight">\(x_p\)</span> parameter</p></li>
<li><p><strong>bkg</strong> (<em>float</em>) – log of B parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Calculated model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.models.PowerLawPM">
<code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">PowerLawPM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">alpha</span></em>, <em class="sig-param"><span class="n">norm</span></em>, <em class="sig-param"><span class="n">pivot</span></em>, <em class="sig-param"><span class="n">bkg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#PowerLawPM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.PowerLawPM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyproffit.models.Vikhlinin">
<code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">Vikhlinin</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">beta</span></em>, <em class="sig-param"><span class="n">rc</span></em>, <em class="sig-param"><span class="n">alpha</span></em>, <em class="sig-param"><span class="n">rs</span></em>, <em class="sig-param"><span class="n">epsilon</span></em>, <em class="sig-param"><span class="n">gamma</span></em>, <em class="sig-param"><span class="n">norm</span></em>, <em class="sig-param"><span class="n">bkg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#Vikhlinin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.Vikhlinin" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplified Vikhlinin+06 surface brightness model used in Ghirardini+19</p>
<div class="math notranslate nohighlight">
\[I(r) = I_0\left( \frac{x}{r_c}\right)^{-\alpha} \left(1+(x/r_c)^2 \right)^{-3\beta + \alpha/2} \left( 1 + (x/r_s)^{\gamma} \right)^{-\epsilon/\gamma}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Radius in arcmin</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – <span class="math notranslate nohighlight">\(\beta\)</span> parameter</p></li>
<li><p><strong>rc</strong> (<em>float</em>) – rc parameter</p></li>
<li><p><strong>norm</strong> (<em>float</em>) – log of I0 parameter</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – <span class="math notranslate nohighlight">\(\alpha\)</span> parameter</p></li>
<li><p><strong>rs</strong> (<em>float</em>) – rs parameter</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – <span class="math notranslate nohighlight">\(\epsilon\)</span> parameter</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – <span class="math notranslate nohighlight">\(\gamma\)</span> parameter</p></li>
<li><p><strong>bkg</strong> (<em>float</em>) – log of B parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Calculated model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.models.VikhlininPM">
<code class="sig-prename descclassname">pyproffit.models.</code><code class="sig-name descname">VikhlininPM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">beta</span></em>, <em class="sig-param"><span class="n">rc</span></em>, <em class="sig-param"><span class="n">alpha</span></em>, <em class="sig-param"><span class="n">rs</span></em>, <em class="sig-param"><span class="n">epsilon</span></em>, <em class="sig-param"><span class="n">gamma</span></em>, <em class="sig-param"><span class="n">norm</span></em>, <em class="sig-param"><span class="n">bkg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/models.html#VikhlininPM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.models.VikhlininPM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-pyproffit.power_spectrum">
<span id="pyproffit-power-spectrum-module"></span><h2>pyproffit.power_spectrum module<a class="headerlink" href="#module-pyproffit.power_spectrum" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyproffit.power_spectrum.PowerSpectrum">
<em class="property">class </em><code class="sig-prename descclassname">pyproffit.power_spectrum.</code><code class="sig-name descname">PowerSpectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">profile</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/power_spectrum.html#PowerSpectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.power_spectrum.PowerSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to perform fluctuation power spectrum analysis from Poisson count images. This is the code used in Eckert et al. 2017.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (class:<cite>pyproffit.data.Data</cite>) – Object of type <a class="reference internal" href="#pyproffit.data.Data" title="pyproffit.data.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyproffit.data.Data</span></code></a> including the image, exposure map, background map, and region definition</p></li>
<li><p><strong>profile</strong> (class:<cite>pyproffit.profextract.Profile</cite>) – Object of type <a class="reference internal" href="#pyproffit.profextract.Profile" title="pyproffit.profextract.Profile"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyproffit.profextract.Profile</span></code></a> including the extracted surface brightness profile</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyproffit.power_spectrum.PowerSpectrum.MexicanHat">
<code class="sig-name descname">MexicanHat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">modimg_file</span></em>, <em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">region_size</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">factshift</span><span class="o">=</span><span class="default_value">1.5</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/power_spectrum.html#PowerSpectrum.MexicanHat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.power_spectrum.PowerSpectrum.MexicanHat" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolve the input image and model image with a set of Mexican Hat filters at various scales. The convolved images are automatically stored into FITS images called conv_scale_xx.fits and conv_beta_xx.fits, with xx the scale in kpc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>modimg_file</strong> (<em>str</em>) – Path to a FITS file including the model image, typically produced with <a class="reference internal" href="#pyproffit.profextract.Profile.SaveModelImage" title="pyproffit.profextract.Profile.SaveModelImage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyproffit.profextract.Profile.SaveModelImage()</span></code></a></p></li>
<li><p><strong>z</strong> (<em>float</em>) – Source redshift</p></li>
<li><p><strong>region_size</strong> (<em>float</em>) – Size of the region of interest in Mpc. Defaults to 1.0</p></li>
<li><p><strong>factshift</strong> (<em>float</em>) – Size of the border around the region, i.e. a region of size factshift * region_size is used for the computation. Defaults to 1.5</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.power_spectrum.PowerSpectrum.PS">
<code class="sig-name descname">PS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">region_size</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">radius_in</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">radius_out</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/power_spectrum.html#PowerSpectrum.PS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.power_spectrum.PowerSpectrum.PS" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the power spectrum from existing Mexican Hat images in a given circle or annulus</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>float</em>) – Source redshift</p></li>
<li><p><strong>region_size</strong> (<em>float</em>) – Size of the region of interest in Mpc. Defaults to 1.0. This value must be equal to the region_size parameter used in <a class="reference internal" href="#pyproffit.power_spectrum.PowerSpectrum.MexicanHat" title="pyproffit.power_spectrum.PowerSpectrum.MexicanHat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyproffit.power_spectrum.PowerSpectrum.MexicanHat()</span></code></a>.</p></li>
<li><p><strong>radius_in</strong> (<em>float</em>) – Inner boundary in Mpc of the annulus to be used. Defaults to 0.0</p></li>
<li><p><strong>radius_out</strong> (<em>float</em>) – Outer boundary in Mpc of the annulus to be used. Defaults to 1.0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.power_spectrum.PowerSpectrum.Plot">
<code class="sig-name descname">Plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_plots</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">outps</span><span class="o">=</span><span class="default_value">'power_spectrum.pdf'</span></em>, <em class="sig-param"><span class="n">outamp</span><span class="o">=</span><span class="default_value">'a2d.pdf'</span></em>, <em class="sig-param"><span class="n">plot_3d</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">cfact</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/power_spectrum.html#PowerSpectrum.Plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.power_spectrum.PowerSpectrum.Plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the loaded power spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_plots</strong> (<em>bool</em>) – Indicate whether the plot should be saved to disk or not. Defaults to True.</p></li>
<li><p><strong>outps</strong> (<em>str</em>) – Name of output file. Defaults to ‘power_spectrum.pdf’</p></li>
<li><p><strong>outamp</strong> (<em>str</em>) – Name of output file to save the 2D amplitude plot. Defaults to ‘a2d.pdf’</p></li>
<li><p><strong>plot_3d</strong> (<em>bool</em>) – Add or not the 3D power spectrum to the plot. Defaults to False</p></li>
<li><p><strong>cfact</strong> (class:<cite>numpy.ndarray</cite> , optional) – 2D to 3D projection factor</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.power_spectrum.PowerSpectrum.ProjectionFactor">
<code class="sig-name descname">ProjectionFactor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">betaparams</span></em>, <em class="sig-param"><span class="n">region_size</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/power_spectrum.html#PowerSpectrum.ProjectionFactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.power_spectrum.PowerSpectrum.ProjectionFactor" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute numerically the 2D to 3D deprojection factor. The routine is simulating 3D fluctuations using the surface brightness model and the region mask, projecting the 3D data along one axis, and computing the ratio of 2D to 3D power as a function of scale.</p>
<p>Caution: this is a memory intensive computation which will run into memory overflow if the image size is too large or the available memory is insufficient.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>float</em>) – Source redshift</p></li>
<li><p><strong>betaparams</strong> (class:<cite>numpy.ndarray</cite>) – Parameters of the beta model or double beta model</p></li>
<li><p><strong>region_size</strong> (<em>float</em>) – Size of the region of interest in Mpc. Defaults to 1.0. This value must be equal to the region_size parameter used in <a class="reference internal" href="#pyproffit.power_spectrum.PowerSpectrum.MexicanHat" title="pyproffit.power_spectrum.PowerSpectrum.MexicanHat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyproffit.power_spectrum.PowerSpectrum.MexicanHat()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of projection factors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class:<cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.power_spectrum.PowerSpectrum.Save">
<code class="sig-name descname">Save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outfile</span></em>, <em class="sig-param"><span class="n">outcov</span><span class="o">=</span><span class="default_value">'covariance.txt'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/power_spectrum.html#PowerSpectrum.Save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.power_spectrum.PowerSpectrum.Save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the loaded power spectra to an output ASCII file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outfile</strong> (<em>str</em>) – Name of output ASCII file</p></li>
<li><p><strong>outcov</strong> (<em>str</em>) – Output covariance matrix. Defaults to ‘covariance.txt’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyproffit.power_spectrum.betamodel">
<code class="sig-prename descclassname">pyproffit.power_spectrum.</code><code class="sig-name descname">betamodel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">par</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/power_spectrum.html#betamodel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.power_spectrum.betamodel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyproffit.power_spectrum.calc_mexicanhat">
<code class="sig-prename descclassname">pyproffit.power_spectrum.</code><code class="sig-name descname">calc_mexicanhat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sc</span></em>, <em class="sig-param"><span class="n">img</span></em>, <em class="sig-param"><span class="n">mask</span></em>, <em class="sig-param"><span class="n">simmod</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/power_spectrum.html#calc_mexicanhat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.power_spectrum.calc_mexicanhat" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter an input image with a Mexican-hat filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sc</strong> (<em>float</em>) – Mexican Hat scale in pixel</p></li>
<li><p><strong>img</strong> (class:<cite>numpy.ndarray</cite>) – Image to be smoothed</p></li>
<li><p><strong>mask</strong> (class:<cite>numpy.ndarray</cite>) – Mask image</p></li>
<li><p><strong>simmod</strong> (class:<cite>numpy.ndarray</cite>) – Model surface brightness image</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mexican Hat convolved image and SB model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class:<cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.power_spectrum.calc_projection_factor">
<code class="sig-prename descclassname">pyproffit.power_spectrum.</code><code class="sig-name descname">calc_projection_factor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nn</span></em>, <em class="sig-param"><span class="n">mask</span></em>, <em class="sig-param"><span class="n">betaparams</span></em>, <em class="sig-param"><span class="n">scale</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/power_spectrum.html#calc_projection_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.power_spectrum.calc_projection_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute numerically the 2D to 3D deprojection factor. The routine is simulating 3D fluctuations using the surface brightness model and the region mask, projecting the 3D data along one axis, and computing the ratio of 2D to 3D power as a function of scale.</p>
<p>Caution: this is a memory intensive computation which will run into memory overflow if the image size is too large or the available memory is insufficient.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nn</strong> (<em>int</em>) – Image size in pixel</p></li>
<li><p><strong>mask</strong> (class:<cite>numpy.ndarray</cite>) – Array defining the mask of active pixels, of size (nn , nn)</p></li>
<li><p><strong>betaparams</strong> (class:<cite>numpy.ndarray</cite>) – Parameters of the beta model or double beta model</p></li>
<li><p><strong>scale</strong> (class:<cite>numpy.ndarray</cite>) – Array of scales at which the projection factor should be computed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array containing wave number, 2D power, 2D amplitude, and 3D power</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class:<cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.power_spectrum.calc_ps">
<code class="sig-prename descclassname">pyproffit.power_spectrum.</code><code class="sig-name descname">calc_ps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">region</span></em>, <em class="sig-param"><span class="n">img</span></em>, <em class="sig-param"><span class="n">mod</span></em>, <em class="sig-param"><span class="n">kr</span></em>, <em class="sig-param"><span class="n">nreg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/power_spectrum.html#calc_ps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.power_spectrum.calc_ps" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the power at a given scale kr from the Mexican Hat filtered images</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>region</strong> (class:<cite>numpy.ndarray</cite>) – Index defining the region from which the power spectrum will be extracted</p></li>
<li><p><strong>img</strong> (class:<cite>numpy.ndarray</cite>) – Mexican Hat filtered image</p></li>
<li><p><strong>mod</strong> (class:<cite>numpy.ndarray</cite>) – Mexican Hat filtered SB model</p></li>
<li><p><strong>kr</strong> (<em>float</em>) – Extraction scale</p></li>
<li><p><strong>nreg</strong> (<em>int</em>) – Number of subregions into which the image should be splitted to perform the bootstrap</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ps (float): Power at scale kr</p></li>
<li><p>psnoise (float): Noise at scale kr</p></li>
<li><p>vals (class:<cite>numpy.ndarray</cite>): set of values for bootstrap error calculation</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.power_spectrum.do_bootstrap">
<code class="sig-prename descclassname">pyproffit.power_spectrum.</code><code class="sig-name descname">do_bootstrap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vals</span></em>, <em class="sig-param"><span class="n">nsample</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/power_spectrum.html#do_bootstrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.power_spectrum.do_bootstrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the covariance matrix of power spectra by bootstrapping the image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vals</strong> (class:<cite>numpy.ndarray</cite>) – Set of values</p></li>
<li><p><strong>nsample</strong> (<em>int</em>) – Number of bootstrap samples</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2D covariance matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class:<cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyproffit.power_spectrum.doublebeta">
<code class="sig-prename descclassname">pyproffit.power_spectrum.</code><code class="sig-name descname">doublebeta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">pars</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/power_spectrum.html#doublebeta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.power_spectrum.doublebeta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-pyproffit.profextract">
<span id="pyproffit-profextract-module"></span><h2>pyproffit.profextract module<a class="headerlink" href="#module-pyproffit.profextract" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyproffit.profextract.Profile">
<em class="property">class </em><code class="sig-prename descclassname">pyproffit.profextract.</code><code class="sig-name descname">Profile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">center_choice</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">maxrad</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">binsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">center_ra</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">center_dec</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">binning</span><span class="o">=</span><span class="default_value">'linear'</span></em>, <em class="sig-param"><span class="n">centroid_region</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/profextract.html#Profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.profextract.Profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>pyproffit.Profile class. The class allows the user to extract surface brightness profiles and use them to fit models, extract density profiles, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (class:<cite>pyproffit.Data</cite>) – Object of type <a class="reference internal" href="#pyproffit.data.Data" title="pyproffit.data.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyproffit.data.Data</span></code></a> containing the data to be used</p></li>
<li><p><strong>center_choice</strong> (<em>str</em>) – <p>Choice of the center of the surface brightness profile. Available options are “centroid”, “peak”, “custom_ima” and “custom_fk5”.
Args:</p>
<blockquote>
<div><ul>
<li><p>’centroid’: Compute image centroid and ellipticity. This is done by performing principle component analysis on the count image. If a dmfilth image exists, it will be used instead of the original count image.</p></li>
<li><p>’peak’: Compute the surface brightness peak, The peak is computed as the maximum of the count image after a light smoothing. If a dmfilth image exists, it will be used instead of the original count image.</p></li>
<li><p>’custom_fk5’: Use any custom center in FK5 coordinates, provided by the “center_ra” and “center_dec” arguments</p></li>
<li><p>’custom_ima’: Similar to ‘custom_fk5’ but with input coordinates in image pixels</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>maxrad</strong> (<em>float</em>) – The maximum radius (in arcmin) out to which the surface brightness profile will be computed</p></li>
<li><p><strong>binsize</strong> (<em>float</em>) – Minumum bin size (in arcsec).</p></li>
<li><p><strong>center_ra</strong> (<em>float</em>) – User defined center R.A. If center_choice=’custom_fk5’ this is the right ascension in degrees. If center_choice=’custom_ima’ this is the image pixel on the X axis. If center_choice=’peak’ or ‘centroid’ this is not used.</p></li>
<li><p><strong>center_dec</strong> (<em>float</em>) – User defined center declination. If center_choice=’custom_fk5’ this is the declination in degrees. If center_choice=’custom_ima’ this is the image pixel on the Y axis. If center_choice=’peak’ or ‘centroid’ this is not used.</p></li>
<li><p><strong>binning</strong> (<em>str</em>) – <p>Binning type. Available types are ‘linear’, ‘log’ or ‘custom’. Defaults to ‘linear’.
Args:</p>
<blockquote>
<div><ul>
<li><p>’linear’: Use a linear radial binning with bin size equal to ‘binsize’</p></li>
<li><p>’log’: Use logarithmic binning, i.e. bin size increasing logarithmically with radius with a minimum bin size given by ‘binsize’</p></li>
<li><p>’custom’: Any user-defined binning in the form of an input numpy array provided through the ‘bins’ option</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>centroid_region</strong> (<em>float</em>) – If center_choice=’centroid’, this option defines the radius of the region (in arcmin), centered on the center of the image, within which the centroid will be calculated. If centroid_region=None the entire image is used. Defaults to None.</p></li>
<li><p><strong>bins</strong> (class:<cite>numpy.ndarray</cite>) – in case binning is set to ‘custom’, a numpy array containing the binning definition. For an input array of length N, the binning will contain N-1 bins with boundaries set as the values of the input array.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyproffit.profextract.Profile.Backsub">
<code class="sig-name descname">Backsub</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fitter</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/profextract.html#Profile.Backsub"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.profextract.Profile.Backsub" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract a fitted background value from the loaded surface brightness profile. Each pyproffit model contains a ‘bkg’ parameter, which will be fitted and loaded in a Fitter object. The routine reads the value of ‘bkg’, subtracts it from the data, and adds its error in quadrature to the error profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fitter</strong> (class:<cite>pyproffit.fitting.Fitter</cite>) – Object of type <a class="reference internal" href="#pyproffit.fitting.Fitter" title="pyproffit.fitting.Fitter"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyproffit.fitting.Fitter</span></code></a> containing a model and optimization results</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.profextract.Profile.Emissivity">
<code class="sig-name descname">Emissivity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nh</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kt</span><span class="o">=</span><span class="default_value">6.0</span></em>, <em class="sig-param"><span class="n">rmf</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Z</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">elow</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">ehigh</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">arf</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">type</span><span class="o">=</span><span class="default_value">'cr'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/profextract.html#Profile.Emissivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.profextract.Profile.Emissivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Use XSPEC to compute the conversion from count rate to emissivity using the pyproffit.calc_emissivity routine (see its description)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>float</em>) – Source redshift</p></li>
<li><p><strong>nh</strong> (<em>float</em>) – Source NH in units of 1e22 cm**(-2)</p></li>
<li><p><strong>kt</strong> (<em>float</em>) – Source temperature in keV. Default to 6.0</p></li>
<li><p><strong>rmf</strong> (<em>str</em>) – Path to response file (RMF/RSP)</p></li>
<li><p><strong>Z</strong> (<em>float</em>) – Metallicity with respect to solar. Defaults to 0.3</p></li>
<li><p><strong>elow</strong> (<em>float</em>) – Low-energy bound of the input image in keV. Defaults to 0.5</p></li>
<li><p><strong>ehigh</strong> (<em>float</em>) – High-energy bound of the input image in keV. Defaults to 2.0</p></li>
<li><p><strong>arf</strong> (<em>str</em><em> , </em><em>optional</em>) – Path to on-axis ARF in case response file type is RMF)</p></li>
<li><p><strong>type</strong> (<em>str</em>) – Specify whether the exposure map is in units of sec (type=’cr’) or photon flux (type=’photon’). Defaults to ‘cr’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Conversion factor</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.profextract.Profile.MedianSB">
<code class="sig-name descname">MedianSB</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/profextract.html#Profile.MedianSB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.profextract.Profile.MedianSB" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the median surface brightness profile in circular annuli from a provided Voronoi binned image, following the method outlined in Eckert et al. 2015</p>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.profextract.Profile.PSF">
<code class="sig-name descname">PSF</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">psffunc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">psffile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">psfimage</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">psfpixsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sourcemodel</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/profextract.html#Profile.PSF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.profextract.Profile.PSF" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to calculate a PSF convolution matrix given an input PSF image or function.
To compute the PSF mixing matrix, images of each annuli are convolved with the PSF image using FFT and determine the fraction of photons leaking into neighbouring annuli. FFT-convolved images are then used to determine a mixing matrix. See Eckert et al. 2020 for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psffunc</strong> (<em>function</em>) – Function describing the radial shape of the PSF, with the radius in arcmin</p></li>
<li><p><strong>psffile</strong> (<em>str</em>) – Path to file containing an image of the PSF. The pixel size must be equal to the pixel size of the image.</p></li>
<li><p><strong>psfimage</strong> (class:<cite>numpy.ndarray</cite>) – Array containing an image of the PSF. The pixel size must be equal to the pixel size of the image.</p></li>
<li><p><strong>psfpixsize</strong> (<em>float</em>) – (currently inactive) Pixel size of the PSF image in arcsec. Currently not implemented.</p></li>
<li><p><strong>sourcemodel</strong> (class:<cite>pyproffit.models.Model</cite>) – Object of type <a class="reference internal" href="#pyproffit.models.Model" title="pyproffit.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyproffit.models.Model</span></code></a> including a surface brightness model to account for surface brightness gradients across the bins. If sourcemodel=None a flat distribution is assumed across each bin. Defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.profextract.Profile.Plot">
<code class="sig-name descname">Plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">axes</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/profextract.html#Profile.Plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.profextract.Profile.Plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the loaded surface brightness profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (class:<cite>pyproffit.models.Model</cite> , optional) – If model is not None, plot the provided model of type <a class="reference internal" href="#pyproffit.models.Model" title="pyproffit.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyproffit.models.Model</span></code></a> together with the data. Defaults to None</p></li>
<li><p><strong>outfile</strong> (<em>str</em><em> , </em><em>optional</em>) – If outfile is not None, name of output file to save the plot. Defaults to None</p></li>
<li><p><strong>axes</strong> (<em>list</em><em> , </em><em>optional</em>) – List of 4 numbers defining the X and Y axis ranges for the plot. Gives axes=[x1, x2, y1, y2], the X axis will be set between x1 and x2, and the Y axis will be set between y1 and y2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.profextract.Profile.SBprofile">
<code class="sig-name descname">SBprofile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ellipse_ratio</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">ellipse_angle</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">angle_low</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">angle_high</span><span class="o">=</span><span class="default_value">360.0</span></em>, <em class="sig-param"><span class="n">voronoi</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/profextract.html#Profile.SBprofile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.profextract.Profile.SBprofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract a surface brightness profile and store the results in the input Profile object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ellipse_ratio</strong> (<em>float</em>) – Ratio a/b of major to minor axis in the case of an elliptical annulus definition. Defaults to 1.0, i.e. circular annuli.</p></li>
<li><p><strong>ellipse_angle</strong> (<em>float</em>) – Position angle of the elliptical annulus respective to the R.A. axis. Defaults 0.</p></li>
<li><p><strong>angle_low</strong> (<em>float</em>) – In case the surface brightness profile should be extracted across a sector instead of the whole azimuth, lower position angle of the sector respective to the R.A. axis. Defaults to 0</p></li>
<li><p><strong>angle_high</strong> (<em>float</em>) – In case the surface brightness profile should be extracted across a sector instead of the whole azimuth, upper position angle of the sector respective to the R.A. axis. Defaults to 360</p></li>
<li><p><strong>voronoi</strong> (<em>bool</em>) – Set whether the input data is a Voronoi binned image (True) or a standard raw count image (False). Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.profextract.Profile.Save">
<code class="sig-name descname">Save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/profextract.html#Profile.Save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.profextract.Profile.Save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the data loaded in the Profile class into an output FITS file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outfile</strong> (<em>str</em>) – Output file name</p></li>
<li><p><strong>model</strong> (class:<cite>pyproffit.models.Model</cite>  , optional) – If model is not None, Object of type <a class="reference internal" href="#pyproffit.models.Model" title="pyproffit.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyproffit.models.Model</span></code></a> including the fitted model. Defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyproffit.profextract.Profile.SaveModelImage">
<code class="sig-name descname">SaveModelImage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">outfile</span></em>, <em class="sig-param"><span class="n">vignetting</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyproffit/profextract.html#Profile.SaveModelImage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyproffit.profextract.Profile.SaveModelImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a model image and output it to a FITS file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (class:<cite>pyproffit.models.Model</cite>) – Object of type <a class="reference internal" href="#pyproffit.models.Model" title="pyproffit.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyproffit.models.Model</span></code></a> including the surface brightness model</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Name of output file</p></li>
<li><p><strong>vignetting</strong> (<em>bool</em>) – Choose whether the model will be convolved with the vignetting model (i.e. multiplied by the exposure map) or if the actual surface brightness will be extracted (False). Defaults to True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyproffit">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyproffit" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="Example.html" class="btn btn-neutral float-left" title="Example: Surface brightness profile extraction and fitting with PyProffit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, D. Eckert

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>